---
interface Props {
  label: string;
  value: string | number;
  change?: number;
  unit?: string;
  trend?: "up" | "down" | "stable" | "flat";
  class?: string;
}

const {
  label,
  value,
  change,
  unit = "",
  trend,
  class: className = "",
} = Astro.props;

// Normalize 'flat' to 'stable' for consistency
const normalizedTrend = trend === "flat" ? "stable" : trend;

const trendColors: Record<string, string> = {
  up: "text-success",
  down: "text-danger",
  stable: "text-text-secondary",
};

const trendIcons: Record<string, string> = {
  up: "↑",
  down: "↓",
  stable: "→",
};

// Determine trend from change if not explicitly provided
const displayTrend = normalizedTrend ?? (change !== undefined ? (change > 0 ? "up" : change < 0 ? "down" : "stable") : undefined);
---

<div
  class:list={[
    "bg-bg-surface border border-border rounded-lg p-4",
    className,
  ]}
>
  <p class="text-xs font-medium text-text-secondary uppercase tracking-wide mb-1">
    {label}
  </p>
  <div class="flex items-baseline gap-2">
    <span class="text-2xl font-semibold text-text-primary">
      {value}{unit && <span class="text-lg text-text-secondary">{unit}</span>}
    </span>
    {
      displayTrend && (
        <span class:list={["text-sm font-medium flex items-center gap-0.5", trendColors[displayTrend]]}>
          <span>{trendIcons[displayTrend]}</span>
          {change !== undefined && <span>{Math.abs(change).toFixed(2)}</span>}
        </span>
      )
    }
  </div>
</div>
